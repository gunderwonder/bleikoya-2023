{"version":3,"file":"core-scroll.min.js","sources":["../utils.js","core-scroll.js"],"sourcesContent":["export const IS_BROWSER = typeof window !== 'undefined'\nconst HAS_NAVIGATOR = IS_BROWSER && typeof window.navigator !== 'undefined'\nexport const IS_ANDROID = HAS_NAVIGATOR && /(android)/i.test(navigator.userAgent) // Bad, but needed\nexport const IS_IOS = HAS_NAVIGATOR && /iPad|iPhone|iPod/.test(String(navigator.platform))\nexport const IS_IE11 = IS_BROWSER && window.msCrypto // msCrypto only exists in IE11\n\n// Mock HTMLElement for Node\nif (!IS_BROWSER && !global.HTMLElement) {\n  global.HTMLElement = class {}\n}\n\n/**\n* addEvent\n* @param {String} nodeName An unique ID of the event to bind - ensurnes single instance\n* @param {String} type The type of event to bind\n* @param {Function} handler The function to call on event\n* @param {Boolean|Object} options useCapture or options object for addEventListener. Defaults to false\n*/\nexport function addEvent (nodeName, type, handler, options = false, key) {\n  if (!IS_BROWSER || window[key = `event-${nodeName}-${type}`]) return // Ensure single instance\n  const node = (type === 'resize' || type === 'load') ? window : document\n  node.addEventListener(window[key] = type, (event) => (event.nodeName = nodeName) && handler(event), options)\n}\n\n/**\n* addStyle\n* @param {String} nodeName An unique ID of the event to bind - ensurnes single instance\n* @param {String} css The css to inject\n*/\nexport function addStyle (nodeName, css) {\n  const key = `style-${nodeName.toLowerCase()}`\n  const min = css.replace(/\\/\\*[^!][^*]*\\*\\//g, '').replace(/\\s*(^|[:;,{}]|$)\\s*/g, '$1')\n  document.getElementById(key) || document.head.insertAdjacentHTML('afterbegin', `<style id=\"${key}\">${min}</style>`)\n}\n\n/**\n* escapeHTML\n* @param {String} str A string with potential html tokens\n* @return {String} Escaped HTML string according to OWASP recommendation\n*/\nconst ESCAPE_MAP = { '&': '&amp;', '<': '&lt;', '>': '&gt;', '\"': '&quot;', '/': '&#x2F;', '\\'': '&#x27;' }\nexport function escapeHTML (str) {\n  return String(str || '').replace(/[&<>\"'/]/g, (char) => ESCAPE_MAP[char])\n}\n\n/**\n* closest\n* @param {Element} element Element to traverse up from\n* @param {String} selector A selector to search for matching parents or element itself\n* @return {Element|null}  Element which is the closest ancestor matching selector\n*/\nexport const closest = (() => {\n  const proto = typeof window === 'undefined' ? {} : window.Element.prototype\n  const match = proto.matches || proto.msMatchesSelector || proto.webkitMatchesSelector\n  return proto.closest\n    ? (el, css) => el.closest(css)\n    : (el, css) => {\n      // IE jumps to shadow SVG DOM on clicking an SVG defined by <use>.\n      // If so, jump back to <use> element and traverse real DOM\n        if (el.correspondingUseElement) el = el.correspondingUseElement\n        for (;el; el = el.parentElement) if (match.call(el, css)) return el\n        return null\n      }\n})()\n\n/**\n* dispatchEvent - with infinite loop prevention\n* @param {Element} element The target object\n* @param {String} name The event name\n* @param {Object} detail Detail object (bubbles and cancelable is set to true)\n* @return {Boolean} Whether the event was canceled. Returns true if either event's cancelable attribute value is false or its preventDefault() method was not invoked, and false otherwise.\n*/\nexport function dispatchEvent (element, name, detail = {}) {\n  const ignore = `prevent_recursive_dispatch_maximum_callstack${name}`\n  let event\n\n  if (element[ignore]) return true // We are already processing this event, so skip sending a new one\n  else element[ignore] = true // Add name to dispatching ignore\n\n  if (typeof window.CustomEvent === 'function') {\n    event = new window.CustomEvent(name, { bubbles: true, cancelable: true, detail })\n  } else {\n    event = document.createEvent('CustomEvent')\n    event.initCustomEvent(name, true, true, detail)\n  }\n  // IE reports incorrect event.defaultPrevented\n  // but correct return value on element.dispatchEvent\n  const result = element.dispatchEvent(event)\n  element[ignore] = null // Remove name from dispatching ignore\n\n  return result // Follow W3C standard for return value\n}\n\n/**\n* getUUID\n* @return {String} A generated unique ID\n*/\nexport function getUUID () {\n  return Date.now().toString(36) + Math.random().toString(36).slice(2, 5)\n}\n\n/**\n * throttle\n * @param {Function} callback  The new throttled function\n * @param {Number} ms The threshold of milliseconds between each callback\n */\nexport function throttle (callback, ms) {\n  let timer\n  return function (...args) {\n    if (!timer) {\n      timer = setTimeout(function () {\n        callback.apply(this, args)\n        timer = null\n      }, ms)\n    }\n  }\n}\n\n/**\n * toggleAttribute (Ponyfill for IE and Edge, fixes #299)\n * @link https://developer.mozilla.org/en-US/docs/Web/API/Element/toggleAttribute\n * @param {Element} el  Single DOM Element\n * @param {String} name The name of the attribute to be toggled\n * @param {Boolean} force Force attribute to be added or removed regardless of previous state\n */\nexport function toggleAttribute (el, name, force = !this.hasAttribute(name)) {\n  if (!force === el.hasAttribute(name)) el[force ? 'setAttribute' : 'removeAttribute'](name, '')\n  return force\n}\n\n/**\n* queryAll\n* @param {String|NodeList|Array|Element} elements A CSS selector string, nodeList, element array, or single element\n* @param {Element} context Node to look for elements within\n* @return {Element[]} Array of elements\n*/\nexport function queryAll (elements, context = document) {\n  if (elements) {\n    if (elements.nodeType) return [elements]\n    if (typeof elements === 'string') return [].slice.call(context.querySelectorAll(elements))\n    if (elements.length) return [].slice.call(elements)\n  }\n  return []\n}\n","import { IS_BROWSER, addStyle, closest, dispatchEvent, throttle, getUUID, queryAll } from '../utils'\n\n/**\n * @typedef {{ x: number, y: number }} scrollCoords\n */\n\n/**\n * @typedef {object} scrollPoint\n * @property {Number} x\n * @property {Number} y\n * @property {'top' | 'bottom'} prop\n */\n\n/**\n * @typedef {'up'| 'down' | 'left' | 'right'} scrollDirection\n */\n\n/**\n * @typedef {Object} scrollStatus\n * @property {Number} up distance above to bounding element\n * @property {Number} right distance right to bounding element\n * @property {Number} down distance below to bounding element\n * @property {Number} left distance left to bounding element\n */\n\n/**\n * @typedef {scrollDirection | scrollPoint | Element} scrollTarget\n */\n\n/**\n * @typedef {Object} dragType\n * @property {String} animate Id of element to animate\n * @property {Number} diffSumX\n * @property {Number} diffSumY\n * @property {Number} diffX\n * @property {Number} diffY\n * @property {Number} pageX\n * @property {Number} pageY\n * @property {Number} scrollX\n * @property {Number} scrollY\n * @property {HTMLElement} target\n */\n\n/**\n * @type {dragType}\n */\nconst DRAG = {}\nconst MOVE = { up: { y: -1, prop: 'top' }, down: { y: 1, prop: 'bottom' }, left: { x: -1 }, right: { x: 1 } }\nconst MOVE_SIGNIFICANT = 10\nconst NEEDS_MOUSEDOWN = '[contenteditable=\"true\"],input,select,textarea'\nconst EVENT_PASSIVE = ((has = false) => {\n  try { window.addEventListener('test', null, { get passive () { has = { passive: true } } }) } catch (e) {}\n  return has\n})()\n\n// https://css-tricks.com/introduction-reduced-motion-media-query/\nconst requestJumps = IS_BROWSER && window.matchMedia && window.matchMedia('(prefers-reduced-motion)').matches\nconst requestFrame = IS_BROWSER && (window.requestAnimationFrame || window.setTimeout)\n\nexport default class CoreScroll extends HTMLElement {\n  connectedCallback () {\n    // Hide scrollbar in WebKit and default to display block\n    addStyle(this.nodeName, `\n      ${this.nodeName}{display:block}\n      ${this.nodeName}::-webkit-scrollbar{display:none}\n    `)\n\n    this.style.overflow = 'scroll' // Ensure visible scrollbars\n    this.style.webkitOverflowScrolling = 'touch' // Momentum scroll on iOS\n\n    // Calculate sizes for hiding, must be after setting overflow:scroll\n    const barWidth = this.offsetWidth - this.clientWidth\n    const barHeight = this.offsetHeight - this.clientHeight\n\n    // Also ensure height does not grow higher than parent element\n    this.style.marginRight = `-${barWidth}px`\n    this.style.marginBottom = `-${barHeight}px`\n    this.style.maxHeight = `calc(100% + ${barHeight}px)`\n    this._throttledEvent = throttle(this.handleEvent.bind(this), 500)\n\n    this.addEventListener('mousedown', this)\n    this.addEventListener('wheel', this, EVENT_PASSIVE)\n    this.addEventListener('scroll', this._throttledEvent, EVENT_PASSIVE)\n    window.addEventListener('resize', this._throttledEvent, EVENT_PASSIVE)\n    window.addEventListener('load', this) // Update state when we are sure all CSS is loaded\n    document.addEventListener('click', this)\n\n    // Observe children for changes and run this.handleEvent()\n    // - jsx in particular relies on onScrollChange triggering to update button states\n    if (!this._childListObserver && window.MutationObserver) this._childListObserver = new window.MutationObserver(onDOMchange.bind(this))\n    if (this._childListObserver) this._childListObserver.observe(this, { childList: true, subtree: true })\n\n    setTimeout(() => this.handleEvent()) // Initialize buttons after children is parsed\n  }\n\n  disconnectedCallback () {\n    if (this._childListObserver) this._childListObserver.disconnect()\n    this._childListObserver = this._throttledEvent = null // Garbage collection\n    this.removeEventListener('mousedown', this)\n    this.removeEventListener('wheel', this, EVENT_PASSIVE)\n    this.removeEventListener('scroll', this._throttledEvent, EVENT_PASSIVE)\n    window.removeEventListener('resize', this._throttledEvent, EVENT_PASSIVE)\n    window.removeEventListener('load', this)\n    document.removeEventListener('click', this)\n  }\n\n  /**\n   *\n   * @param {Event} event\n   */\n  handleEvent (event = {}) {\n    if (!this.parentNode || event.defaultPrevented) return // Abort if removed from DOM or event is prevented\n    if (event.type === 'wheel') DRAG.animate = false // Stop momentum animation onWheel\n    else if (event.type === 'mousedown') onMousedown.call(this, event)\n    else if (event.type === 'click') {\n      const btn = this.id && closest(event.target, `[for=\"${this.id}\"],[data-for=\"${this.id}\"]`)\n      if (btn && dispatchEvent(this, 'scroll.click', { move: btn.value })) this.scroll(btn.value)\n    } else {\n      const scrollStatus = getScrollStatus(this)\n      updateButtons(this, scrollStatus)\n      dispatchEvent(this, 'scroll.change')\n\n      const cursor = (scrollStatus.left || scrollStatus.right || scrollStatus.up || scrollStatus.down) ? 'grab' : ''\n      if (!event.type) { // Do not change cursor while dragging\n        this.style.cursor = `-webkit-${cursor}`\n        this.style.cursor = cursor\n      }\n    }\n  }\n\n  /**\n   * Scroll to Element, point or cardinal direction within core-scroll\n   * @param {scrollTarget} point Element, {x, y} pixel distance from top/left or cardinal direction ['up', 'down', 'left', 'right']\n   * @returns {Promise<scrollPoint>} scrollPoint\n   */\n  scroll (point) {\n    const endPoint = parsePoint(this, point)\n    const { x, y } = endPoint\n    const uuid = DRAG.animate = getUUID() // Giving the animation an ID to workaround IE timeout issues\n    const friction = this.friction\n    let moveX = requestJumps ? 1 : x - this.scrollLeft\n    let moveY = requestJumps ? 1 : y - this.scrollTop\n\n    return new Promise((resolve) => {\n      const move = () => {\n        if (DRAG.animate === uuid && (Math.round(moveX) || Math.round(moveY))) {\n          this.scrollLeft = x - Math.round(moveX *= friction)\n          this.scrollTop = y - Math.round(moveY *= friction)\n          requestFrame(move)\n        } else {\n          resolve(endPoint)\n        }\n      }\n      move()\n    })\n  }\n\n  get items () { return queryAll(this.getAttribute('items') || this.children, this) }\n\n  // Ensure falsy values becomes ''\n  set items (val) { this.setAttribute('items', val || '') }\n\n  // ScrollLeft can return decimals when browser is zoomed, leading to unwanted negative values\n  get scrollRight () { return Math.max(0, this.scrollWidth - this.clientWidth - this.scrollLeft) }\n\n  // Safeguard for negative due to decimals for scrollTop similar to scrollLeft above\n  get scrollBottom () { return Math.max(0, this.scrollHeight - this.clientHeight - this.scrollTop) }\n\n  // Avoid friction 1 (infinite)\n  get friction () { return Math.min(0.99, this.getAttribute('friction')) || 0.8 }\n\n  set friction (val) { this.setAttribute('friction', val) }\n}\n\nfunction onMousedown (event) {\n  if (closest(event.target, NEEDS_MOUSEDOWN)) return\n  if (event.button !== 0) return // Only react to left clicking\n  event.preventDefault() // Prevent text selection and enable nesting\n\n  DRAG.pageX = event.pageX\n  DRAG.pageY = event.pageY\n  DRAG.diffSumX = 0\n  DRAG.diffSumY = 0\n  DRAG.animate = DRAG.diffX = DRAG.diffY = 0 // Reset\n  DRAG.scrollX = this.scrollLeft\n  DRAG.scrollY = this.scrollTop\n  DRAG.target = this\n\n  document.body.style.cursor = this.style.cursor = '-webkit-grabbing'\n  document.body.style.cursor = this.style.cursor = 'grabbing'\n  document.addEventListener('mousemove', onMousemove)\n  document.addEventListener('mouseup', onMouseup)\n}\n\nfunction onMousemove (event) {\n  DRAG.diffX = DRAG.pageX - (DRAG.pageX = event.pageX)\n  DRAG.diffY = DRAG.pageY - (DRAG.pageY = event.pageY)\n  DRAG.diffSumX += DRAG.diffX\n  DRAG.diffSumY += DRAG.diffY\n  DRAG.target.scrollLeft = DRAG.scrollX += DRAG.diffX\n  DRAG.target.scrollTop = DRAG.scrollY += DRAG.diffY\n\n  // Prevent links when we know there has been significant movement\n  if (Math.max(Math.abs(DRAG.diffSumX), Math.abs(DRAG.diffSumY)) > MOVE_SIGNIFICANT) {\n    DRAG.target.style.pointerEvents = 'none'\n  }\n}\n\nfunction onMouseup (event) {\n  const momentum = Math.abs(DRAG.diffX || DRAG.diffY) > MOVE_SIGNIFICANT ? 20 : 0\n  document.removeEventListener('mousemove', onMousemove)\n  document.removeEventListener('mouseup', onMouseup)\n  document.body.style.cursor = ''\n\n  if (momentum) {\n    DRAG.target.scroll({\n      x: DRAG.scrollX + DRAG.diffX * momentum,\n      y: DRAG.scrollY + DRAG.diffY * momentum\n    })\n  }\n  DRAG.target.style.pointerEvents = '' // Allow events again\n  DRAG.target.style.cursor = '-webkit-grab'\n  DRAG.target.style.cursor = 'grab'\n  DRAG.target = null // Prevent memory leak\n}\n\n/**\n * Takes an element, coordinates or cardinal direction and returns x/y -coordinates\n * @param {CoreScroll} self CoreScroll HTMLElement\n * @param {scrollTarget} move\n * @returns {scrollPoint}\n */\nfunction parsePoint (self, move) {\n  const scrollItems = self.items\n  // Move is an element within CoreScroll\n  const toItem = move && move.nodeType && scrollItems.filter((item) => item.contains(move))[0]\n  if (toItem) {\n    // Target offset subtracting CoreScroll offset and half of offsetHeight/width to center\n    return {\n      x: Math.max(0, toItem.offsetLeft - self.offsetLeft - ((self.offsetWidth / 2) - (toItem.offsetWidth / 2))),\n      y: Math.max(0, toItem.offsetTop - self.offsetTop - ((self.offsetHeight / 2) - (toItem.offsetHeight / 2)))\n    }\n  } else if (move && move.nodeType && !toItem) {\n    console.warn(self, `cannot find child element ${move} as a valid target for scrolling`)\n  }\n  const point = typeof move === 'object' ? move : { move }\n  if (typeof point.x !== 'number') point.x = self.scrollLeft\n  if (typeof point.y !== 'number') point.y = self.scrollTop\n  if ((point.move = MOVE[point.move])) {\n    const axis = point.move.x ? 'x' : 'y'\n    const start = point.move.x ? 'left' : 'top'\n    const bounds = self.getBoundingClientRect()\n    const scroll = bounds[start] - self[point.move.x ? 'scrollLeft' : 'scrollTop']\n    const edge = bounds[start] + bounds[point.move.x ? 'width' : 'height'] * point.move[axis]\n\n    scrollItems.every((el) => { // Use .every as this loop stops on return false\n      const rect = el.getBoundingClientRect()\n      const marg = el.ownerDocument.defaultView.getComputedStyle(el)[`margin-${start}`]\n\n      point[axis] = rect[start] - parseInt(marg, 10) - scroll // Update point to child axis coordinate\n      return rect[point.move.prop || move] < edge\n    })\n  }\n  return {\n    x: Math.max(0, Math.min(point.x, self.scrollWidth - self.clientWidth)),\n    y: Math.max(0, Math.min(point.y, self.scrollHeight - self.clientHeight))\n  }\n}\n\n/**\n * scroll.DOMChange\n *\n * fired when MutationObserver in CoreScroll detects a change in child nodes\n *\n * @event scroll.DOMChange\n * @type {object}\n * @param {NodeList} addedNodes\n * @param {NodeList} removedNodes\n */\n\n/**\n * Handle DOM changes in childlist observed with MutationObserver in CoreScroll\n *\n * @this {CoreScroll} CoreScroll HTMLElement\n * @param {MutationRecord[]} mutationList\n * @fires scroll.DOMChange when a MutationRecord has type childList\n */\nfunction onDOMchange (mutationList) {\n  if (!this.parentNode) return // Abort if removed from DOM\n\n  for (const mutation of mutationList) {\n    /* One or more children have been added to and/or removed from the tree. */\n    if (mutation.type === 'childList') {\n      const scrollStatus = getScrollStatus(this)\n      updateButtons(this, scrollStatus)\n      dispatchEvent(this, 'scroll.change')\n    }\n  }\n}\n\n/**\n * getScrollStatus\n * We floor all values to handle potential decimal leftovers if browser is zoomed in or out\n * @param {CoreScroll} self CoreScroll HTMLElement\n * @returns {scrollStatus} Object with values for distance to bounding element in cardinal directions\n */\nfunction getScrollStatus (self) {\n  return {\n    up: Math.floor(self.scrollTop),\n    right: Math.floor(self.scrollRight),\n    down: Math.floor(self.scrollBottom),\n    left: Math.floor(self.scrollLeft)\n  }\n}\n\n/**\n * Updates disabled attribute on all connected buttons with value set as a scrollDirection\n * @param {CoreScroll} self CoreScroll HTMLElement\n * @param {scrollStatus} scrollStatus\n */\nfunction updateButtons (self, scrollStatus) {\n  queryAll(self.id && `[for=\"${self.id}\"],[data-for=\"${self.id}\"]`).forEach((el) => (el.disabled = !scrollStatus[el.value]))\n}\n"],"names":["IS_BROWSER","window","HAS_NAVIGATOR","navigator","test","userAgent","String","platform","global","HTMLElement","_createClass","_class","_classCallCheck","this","proto","match","closest","Element","prototype","matches","msMatchesSelector","webkitMatchesSelector","el","css","correspondingUseElement","parentElement","call","dispatchEvent","element","name","event","detail","ignore","CustomEvent","bubbles","cancelable","document","createEvent","initCustomEvent","result","queryAll","elements","context","nodeType","slice","querySelectorAll","length","DRAG","MOVE","up","y","prop","down","left","x","right","EVENT_PASSIVE","has","addEventListener","passive","e","requestJumps","matchMedia","requestFrame","requestAnimationFrame","setTimeout","CoreScroll","nodeName","key","min","_this","concat","toLowerCase","replace","getElementById","head","insertAdjacentHTML","style","overflow","webkitOverflowScrolling","callback","ms","timer","barWidth","offsetWidth","clientWidth","barHeight","offsetHeight","clientHeight","marginRight","marginBottom","maxHeight","_throttledEvent","handleEvent","bind","_len","arguments","args","Array","_key","apply","_childListObserver","MutationObserver","onDOMchange","observe","childList","subtree","disconnect","removeEventListener","parentNode","defaultPrevented","type","animate","onMousedown","btn","id","target","move","value","scroll","scrollStatus","getScrollStatus","updateButtons","cursor","point","_this2","endPoint","self","scrollItems","items","toItem","filter","item","contains","Math","max","offsetLeft","offsetTop","console","warn","_typeof","scrollLeft","scrollTop","axis","start","bounds","getBoundingClientRect","edge","every","rect","marg","ownerDocument","defaultView","getComputedStyle","parseInt","scrollWidth","scrollHeight","parsePoint","uuid","Date","now","toString","random","friction","moveX","moveY","Promise","resolve","round","getAttribute","children","set","val","setAttribute","button","preventDefault","pageX","pageY","diffSumX","diffSumY","diffX","diffY","scrollX","scrollY","body","onMousemove","onMouseup","abs","pointerEvents","momentum","mutationList","_step","_iterator","_createForOfIteratorHelper","s","n","done","err","f","floor","scrollRight","scrollBottom","forEach","disabled"],"mappings":"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"}